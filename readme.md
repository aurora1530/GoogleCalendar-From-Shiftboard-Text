# GoogleCalendar-From-Shiftboard-Text
## 概要
シフトボードの共有から生成されたテキストを元に、Google カレンダー上にシフト情報のイベントを生成するGoogle Apps Scriptのコード。

シフトボードは本体カレンダーにシフト情報を共有する機能があり、そのカレンダーを公開カレンダーにすることでGoogle カレンダーにも共有できる。しかし、Google カレンダー側の反映が遅い。このコードでは、手動で関数を実行する必要があるが、確実にカレンダーへ反映することができる。

## 使い方
1. Google Apps Scriptのプロジェクトを作成する。
2. code.jsの中身をコピーし、何らかのgsファイルに貼り付ける。
3. シフト情報をイベントとして登録したいGoogle カレンダーのカレンダーIDを用意する。
4. 3で用意したIDを、1で作製したプロジェクトの「スクリプトプロパティ」に、プロパティを「CALENDAR_ID」として値を保存する。
5. シフトボードを起動し、「マイシフト」→画面左上の「シフトの共有」を開く、対象期間・バイト先の表示の設定を適宜行い、「共有する」をタップ
6. 5で生成されたテキストを、2で貼り付けたコードの`main()`関数の`text`変数に貼り付ける。
7. `main()`関数を実行する。
   - 初回実行時、権限の承認が求められるので注意

## 注意点
- シフトボードが生成するテキストには、シフトの年数が含まれていない。そのため、原則年数はコード実行時の年を指定する。
   - ただし、期間が12月~1月を跨ぐようなテキストを指定した場合は、12月は実行時の年、1月はその次の年が指定される。
- イベントのタイトルは「バイト先名」となる
   - 「バイト先名」は、「使い方」の手順5で「バイト先の表示」を有効にした場合は、それによって挿入されるバイト先名。
   - 無効にしていた場合は、「バイト」が挿入される。
- 「使い方」の手順5で生成したテキストの、最初の日時から最後の日時の間に、既に登録されているイベントがあった場合、デフォルトでは削除される。
   - 削除したくない場合、`main()`関数の`shouldDeleteEvent`という変数で`false`を指定する。
   - 登録されていることの判定は、イベントの説明に「Created By GAS」が含まれているかどうかで判断する。